
## MEV spoof

Sometimes there are profitable trades, but not that often. Sometimes someone is looking to sell 100 widgets at $20 on the American Widget Exchange, and someone else is looking to buy 100 widgets for $21 on the National Widget Exchange. And so you can buy on the AWE and sell on the NWE and make an instant $100 profit. But only _one_ person can do that. Once you buy on the AWE and sell on the NWE, the window is closed.

Who gets to do the trade? The most intuitive answer, in most cases, is “whoever does it first.” If you see the same thing trading for two different prices on two different exchanges, and I don’t, and you send in the orders to the exchanges before me, then you do the trade and I don’t. For most human-scale trades, this makes sense and is easy to administer and feels basically fair.

The US stock market mostly does not operate at human time scales, and there [these intuitions break down](https://link.mail.bloombergbusiness.com/click/35403556.275801/aHR0cHM6Ly93d3cuYmxvb21iZXJnLmNvbS92aWV3L2FydGljbGVzLzIwMTgtMDctMDIvd2FsbC1zdHJlZXQtaXMtc2hhcnBlbmluZy1vdXItbmFub3NlY29uZHM_Y21waWQ9QkJEMDUxNjI0X01PTkVZU1RVRkYmdXRtX21lZGl1bT1lbWFpbCZ1dG1fc291cmNlPW5ld3NsZXR0ZXImdXRtX3Rlcm09MjQwNTE2JnV0bV9jYW1wYWlnbj1tb25leXN0dWZm/60e87ce39a995a4b1a2deb96B591d1ce4). In the stock market, often, one algorithm spots trade opportunities a microsecond before another algorithm, and people get mad about that. They worry that this microsecond-scale competition between algorithms is socially wasteful, and [they worry](https://link.mail.bloombergbusiness.com/click/35403556.275801/aHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvRmxhc2hfQm95cw/60e87ce39a995a4b1a2deb96B07e8cb71) that it is unfair to people with worse algorithms. They think “yes, fine, the first person to see a trade should get to do it, _within reason_, but there’s no social benefit to slicing it that fine.” They propose things like “[frequent batch auctions](https://link.mail.bloombergbusiness.com/click/35403556.275801/aHR0cHM6Ly9hY2FkZW1pYy5vdXAuY29tL3FqZS9hcnRpY2xlLzEzMC80LzE1NDcvMTkxNjE0Ng/60e87ce39a995a4b1a2deb96B13c3142a),” where everyone who sees the same trade within (say) a second of each other gets to compete _on price_ to do it, rather than competing on _time_ down to the microsecond. 

Crypto, however, has a different problem. Time in electronic stock markets is maybe _too_ continuous; the timeline of a stock exchange can be sliced much more finely than the human brain can comprehend. But time in crypto is oddly discrete. Time in crypto is measured in _blocks_. Intuitively, people submit orders to do transactions on a crypto blockchain, and then periodically a batch of those transactions is enshrined in the official ledger of that blockchain. In [Bitcoin](https://link.mail.bloombergbusiness.com/click/35403556.275801/aHR0cHM6Ly93d3cuYmxvY2tjaGFpbi5jb20vZXhwbG9yZXI/60e87ce39a995a4b1a2deb96B0fa1755c), a block contains roughly 10 minutes’ worth of transactions; in [Ethereum](https://link.mail.bloombergbusiness.com/click/35403556.275801/aHR0cHM6Ly9ldGhlcmV1bS5vcmcvZW4vZGV2ZWxvcGVycy9kb2NzL2Jsb2Nrcy8/60e87ce39a995a4b1a2deb96B67d3e976), it’s seconds.

So intuitively, Ethereum transactions happen in big simultaneous bunches every 12 seconds. But the bunches can’t really be simultaneous: If there is one rare nonfungible token for sale, and two people want to buy it, only one of them can. One transaction has to be first. So the transactions within a block are _ordered_; they happen in sequence. But they are not necessarily ordered by _time._

How does the blockchain decide which transactions to record, and in what order? In Ethereum, the answer is: with money. People who want to do transactions on the Ethereum network [pay fees to execute the transactions](https://link.mail.bloombergbusiness.com/click/35403556.275801/aHR0cHM6Ly9ldGhlcmV1bS5vcmcvZW4vZGV2ZWxvcGVycy9kb2NzL2dhcy8/60e87ce39a995a4b1a2deb96B6377dacc); there is a flat base fee, but people can also bid more — a “priority fee” or “tip” — to get their transactions executed quickly. Every 12 seconds, some computer on the Ethereum network is selected to record the transactions in a block. This computer used to be called a “miner,” but in current proof-of-stake Ethereum blocks are recorded by computers called “validators.” Each block is compiled by one validator, [selected](https://link.mail.bloombergbusiness.com/click/35403556.275801/aHR0cHM6Ly9ldGhlcmV1bS5vcmcvZW4vZGV2ZWxvcGVycy9kb2NzL2NvbnNlbnN1cy1tZWNoYW5pc21zL3Bvcy9ibG9jay1wcm9wb3NhbC8/60e87ce39a995a4b1a2deb96Bdd338ae0) more or less at random, called a “proposer”; the other validators vote to accept the block. The validators [share the transaction fees](https://link.mail.bloombergbusiness.com/click/35403556.275801/aHR0cHM6Ly9ldGhlcmV1bS5vcmcvZW4vZGV2ZWxvcGVycy9kb2NzL2NvbnNlbnN1cy1tZWNoYW5pc21zL3Bvcy9yZXdhcmRzLWFuZC1wZW5hbHRpZXMv/60e87ce39a995a4b1a2deb96B46aa51c3), with the block proposer getting more than the other validators.

The block proposer will naturally prioritize the transactions that pay more fees, because then it will get more money. And, again, the validators are all computers; they will be _programmed_ to select the transactions that pay them the most money. And in fact there is a [division of labor](https://link.mail.bloombergbusiness.com/click/35403556.275801/aHR0cHM6Ly9ldGhyZXNlYXIuY2gvdC9wcm9wb3Nlci1ibG9jay1idWlsZGVyLXNlcGFyYXRpb24tZnJpZW5kbHktZmVlLW1hcmtldC1kZXNpZ25zLzk3MjU/60e87ce39a995a4b1a2deb96B650aa3a9) in modern Ethereum, where a computer called a “[block builder](https://link.mail.bloombergbusiness.com/click/35403556.275801/aHR0cHM6Ly9kb2NzLmZsYXNoYm90cy5uZXQvZmxhc2hib3RzLW1ldi1ib29zdC9ibG9jay1idWlsZGVycw/60e87ce39a995a4b1a2deb96B787c7b75)” puts together a list of transactions that will pay the most money to the validators, and then the block proposer proposes a block with that list so it can get paid.

And so if you see 100 widget tokens trading for $20 on one Ethereum decentralized exchange, and 100 widget tokens trading for $21 on another Ethereum decentralized exchange, you can buy them at $20 each and sell them for $21 each and make $100. But if I _also_ see that arbitrage, I will _also_ put in those orders. Which of our trades will execute first? Whoever pays more in execution fees. How much should I offer to pay? Oh, you know, it’s a competitive auction. So roughly $99. The validators should get most of the money from the arbitrage. This is [called “MEV,”](https://link.mail.bloombergbusiness.com/click/35403556.275801/aHR0cHM6Ly93d3cuY29pbmRlc2suY29tL2xlYXJuL3doYXQtaXMtbWV2LWFrYS1tYXhpbWFsLWV4dHJhY3RhYmxlLXZhbHVlLz9fZ2w9MSoxbG1qM3FkKl91cCpNUS4uKl9nYSpNemt4TURNeE1EazVMakUzTVRVM09Ua3dOekkuKl9nYV9WTTNTVFJZVk44Kk1UY3hOVGM1T1RBM01TNHhMakF1TVRjeE5UYzVPVEEzTVM0d0xqQXVNemN3TmpjeU9UZy4/60e87ce39a995a4b1a2deb96Ba6e1a52d) for “miner extractable value,” though now Ethereum doesn’t have miners and the acronym stands much less informatively for “maximal extractable value.”

What are the chances that both of us discovered the same arbitrage within 12 seconds of each other? Well, pretty good, in a competitive market with a lot of arbitrageurs. But also, traditionally, when we want to do these transactions, we submit our orders _publicly_ to the Ethereum network. (To the “[mempool](https://link.mail.bloombergbusiness.com/click/35403556.275801/aHR0cHM6Ly9leHBsb3Jlci5ibG9ja25hdGl2ZS5jb20vP3Y9MS40MS4wJjA9ZXRoZXJldW0mMT1tYWlu/60e87ce39a995a4b1a2deb96B811b3044),” the name given to the place where orders reside before they are included in a block.) Everyone can see the mempool. So if you are a clever speedy arbitrageur, watching a bunch of decentralized exchanges for mispricings, you might see a mispricing and submit your arbitrage orders. And if _I_ am a clever speedy _front-runner_, watching the mempool for arbitrage trades, I would submit the same trades a second or two after you, and pay more to execute them. And then I get to do the arbitrage and you don’t.

But if I am a clever speedy front-runner, I don’t even have to wait for arbitrage trades. Let’s say you are not a clever arbitrageur, but just a person who really likes the [Shiba Inu token](https://link.mail.bloombergbusiness.com/click/35403556.275801/aHR0cHM6Ly9jb2lubWFya2V0Y2FwLmNvbS9jdXJyZW5jaWVzL3NoaWJhLWludS8_dXBkYXRlPTE3MTU4MDQxNTMxMDU/60e87ce39a995a4b1a2deb96B45c36c21) on the Ethereum blockchain. You submit a huge order to buy SHIB on a decentralized exchange. That will, quite predictably, push up the price of SHIB. [[1]](imap://dave%40stucky%2Etech@mail.stucky.tech:993/fetch%3EUID%3E.INBOX%3E5707#footnote-1)  If I see that order, I can just jump ahead of it: I can pay a bit more in transaction fees to get my trades to execute first, and then I can buy the SHIB tokens ahead of you and then _sell_ them to you for a profit, all within the same block.

That seems kind of rough on you? This sort of trade is sometimes called a “[sandwich attack](https://link.mail.bloombergbusiness.com/click/35403556.275801/aHR0cHM6Ly9tZWRpdW0uY29tL0BrYWxleG90c3UvbWV2LXNhbmR3aWNoLWF0dGFjay1leGFtcGxlLXdpdGgtbGl2ZS10cmFuc2FjdGlvbnMtYmQwMmNiY2IzYjlh/60e87ce39a995a4b1a2deb96B30f3a6ff)”: I see your order to buy SHIB, and I sandwich it between my order to buy SHIB (before you do, at a lower price) and my order to sell SHIB (after you do, at a higher price). And people talk about [“generalized front running” as a strategy](https://link.mail.bloombergbusiness.com/click/35403556.275801/aHR0cHM6Ly9hc3NldHMuZXkuY29tL2NvbnRlbnQvZGFtL2V5LXNpdGVzL2V5LWNvbS9lbl91cy90b3BpY3MvZmluYW5jaWFsLXNlcnZpY2VzL2V5LWFuLWludHJvZHVjdGlvbi10by1tYXhpbWFsLWV4dHJhY3RhYmxlLXZhbHVlLW9uLWV0aGVyZXVtLnBkZg/60e87ce39a995a4b1a2deb96B1077fa3c):

> A generalized front-runner bot will search the mempool for profitable transactions, then copy the transaction and replace the sender address with their own, then increase their bid (gas price) to price + x to be included in a block first front running the original searcher.

I am giving a simplistic and somewhat old-fashioned description of MEV, and modern Ethereum has a whole, like, institutional structure around it. There are [private mempools](https://link.mail.bloombergbusiness.com/click/35403556.275801/aHR0cHM6Ly93d3cuY29pbmRlc2suY29tL3RlY2gvMjAyNC8wMS8zMS9pbnNpZGUtdGhlLXByaXZhdGUtbWVtcG9vbHMtd2hlcmUtZXRoZXJldW0tdHJhZGVycy1oaWRlLWZyb20tZnJvbnQtcnVubmluZy1ib3RzLw/60e87ce39a995a4b1a2deb96Bc1aa5b60), where you can hide transactions from bots. There is [Flashbots](https://link.mail.bloombergbusiness.com/click/35403556.275801/aHR0cHM6Ly9kb2NzLmZsYXNoYm90cy5uZXQv/60e87ce39a995a4b1a2deb96B77f1d0d6), “a research and development organization formed to mitigate the negative externalities posed by Maximal Extractable Value (MEV) to stateful blockchains, starting with Ethereum,” which has things like [MEV-Boost](https://link.mail.bloombergbusiness.com/click/35403556.275801/aHR0cHM6Ly9kb2NzLmZsYXNoYm90cy5uZXQvZmxhc2hib3RzLW1ldi1ib29zdC9pbnRyb2R1Y3Rpb24/60e87ce39a995a4b1a2deb96Bc109dc57), which creates “a competitive block-building market” where validators can “maximize their staking reward by selling their blockspace to an open market,” and [MEV-Share](https://link.mail.bloombergbusiness.com/click/35403556.275801/aHR0cHM6Ly9kb2NzLmZsYXNoYm90cy5uZXQvZmxhc2hib3RzLW1ldi1zaGFyZS9pbnRyb2R1Y3Rpb24/60e87ce39a995a4b1a2deb96B82109c0f), “an open-source protocol for users, wallets, and applications to internalize the MEV that their transactions create,” letting them “selectively share data about their transactions with searchers who bid to include the transactions in bundles” and get paid. 

Basically, transaction data on Ethereum is informative, and the value of that information (in making profitable trades) is quantifiable, and there are cutthroat auctions among people who want to use that data to make their own trades, and the people doing the transactions that create the data can themselves get paid for their data. 

There is a sort of cool purity to this. In stock markets, some people are faster than others, and can make money by trading ahead of a big order, [[2]](imap://dave%40stucky%2Etech@mail.stucky.tech:993/fetch%3EUID%3E.INBOX%3E5707#footnote-2)  and people get mad about this and think it is unfair and propose solutions. And when money changes hands for speed advantages — “[payment for order flow](https://link.mail.bloombergbusiness.com/click/35403556.275801/aHR0cHM6Ly93d3cuYmxvb21iZXJnLmNvbS9vcGluaW9uL2FydGljbGVzLzIwMjEtMDItMDUvcm9iaW5ob29kLWdhbWVzdG9wLXNhZ2EtcHJlc3N1cmVzLXBheW1lbnQtZm9yLW9yZGVyLWZsb3c_Y21waWQ9QkJEMDUxNjI0X01PTkVZU1RVRkYmdXRtX21lZGl1bT1lbWFpbCZ1dG1fc291cmNlPW5ld3NsZXR0ZXImdXRtX3Rlcm09MjQwNTE2JnV0bV9jYW1wYWlnbj1tb25leXN0dWZm/60e87ce39a995a4b1a2deb96Bf7e3e519),” “[colocation](https://link.mail.bloombergbusiness.com/click/35403556.275801/aHR0cHM6Ly93d3cubWFya2V0c21lZGlhLmNvbS9yZXZpc2l0aW5nLWZsYXNoLWJveXMv/60e87ce39a995a4b1a2deb96B26d8791d)” — people complain about corruption. In crypto it’s like “let’s create an efficient market in trading ahead of big orders.” I once wrote: “Rather than _solve_ this concern about traditional markets, crypto _made it explicit_.” That feels almost like a general philosophy of crypto: Take the problems of traditional finance and make them, _worse_, sure, but more transparent and visible and explicit and subject to unbridled free markets.

In traditional financial markets, people sometimes get in trouble for “spoofing,” for submitting trade orders designed to fool people (algorithms) about their true trading intent. Every so often, [the spoofer’s defense](https://link.mail.bloombergbusiness.com/click/35403556.275801/aHR0cHM6Ly93d3cuYmxvb21iZXJnLmNvbS9vcGluaW9uL2FydGljbGVzLzIwMTUtMDQtMjIvd2h5LWlzLXNwb29maW5nLWJhZC0_Y21waWQ9QkJEMDUxNjI0X01PTkVZU1RVRkYmdXRtX21lZGl1bT1lbWFpbCZ1dG1fc291cmNlPW5ld3NsZXR0ZXImdXRtX3Rlcm09MjQwNTE2JnV0bV9jYW1wYWlnbj1tb25leXN0dWZm/60e87ce39a995a4b1a2deb96Bd3eb631f) will be “no, all these algorithms are trying to front-run me, they are trying to use my order information to make money by trading ahead of me. So I created fake order information to fool them. I’m the hero in this story; the bots trying to front-run me are the villains.” This tends not to work.

Here, maybe, is the crypto version of that. Bloomberg’s [Ava Benny-Morrison reports](https://link.mail.bloombergbusiness.com/click/35403556.275801/aHR0cHM6Ly93d3cuYmxvb21iZXJnLmNvbS9uZXdzL2FydGljbGVzLzIwMjQtMDUtMTUvbWl0LWJyb3RoZXJzLWFycmVzdGVkLW92ZXItbGlnaHRuaW5nLTI1LW1pbGxpb24tY3J5cHRvLWhlaXN0P2NtcGlkPUJCRDA1MTYyNF9NT05FWVNUVUZGJnV0bV9tZWRpdW09ZW1haWwmdXRtX3NvdXJjZT1uZXdzbGV0dGVyJnV0bV90ZXJtPTI0MDUxNiZ1dG1fY2FtcGFpZ249bW9uZXlzdHVmZg/60e87ce39a995a4b1a2deb96B2c4c509c):

> Two brothers who studied at MIT were charged with exploiting a weakness in the Ethereum blockchain and stealing $25 million in 12 seconds, in what prosecutors called a first-of-its-kind caper.
> 
> Anton Peraire-Bueno, 24, and James Peraire-Bueno, 28, were charged by federal prosecutors in Manhattan with fraud and money laundering offenses. They are accused of carrying out the lightning-fast heist, plotted over the course of months, from their keyboards last year.
> 
> “The brothers, who studied computer science and math at one of the most prestigious universities in the world, allegedly used their specialized skills and education to tamper with and manipulate the protocols relied upon by millions of Ethereum users across the globe,” Damian Williams, the US attorney for the Southern District of New York, said in a statement.

Here are the Justice Department [press release](https://link.mail.bloombergbusiness.com/click/35403556.275801/aHR0cHM6Ly93d3cuanVzdGljZS5nb3YvdXNhby1zZG55L3ByL3R3by1icm90aGVycy1hcnJlc3RlZC1hdHRhY2tpbmctZXRoZXJldW0tYmxvY2tjaGFpbi1hbmQtc3RlYWxpbmctMjUtbWlsbGlvbg/60e87ce39a995a4b1a2deb96B157936d0) and [the indictment](https://link.mail.bloombergbusiness.com/click/35403556.275801/aHR0cHM6Ly93d3cuanVzdGljZS5nb3YvdXNhby1zZG55L21lZGlhLzEzNTE5MzEvZGw/60e87ce39a995a4b1a2deb96B84b4e70d). The gist of it is that, allegedly:

1. The brothers set up “a series of Ethereum validators” so they could build blocks on the Ethereum blockchain.
2. The “targeted three Victim Traders, … who are searchers who operate MEV Bots that specialize in cryptocurrency arbitrage trading.” They “tested a series of bait transactions” to see how the arbitrageurs operated.
3. Then, “after receiving notification that one of their 16 Validators had been selected to validate a new block,” they proposed “at least eight specific transactions (the ‘Lure Transactions’)” that they knew the arbitrageurs would like.
4. Specifically, transactions that the arbitrageurs would like to front-run: “The Victim Traders effectively bought substantial amounts of particular illiquid currencies (the frontrun trades), whose price the Victim Traders expected to increase as a result of the Lure Transactions, for approximately $25 million of various stablecoins … or other more liquid cryptocurrencies. The Victim Traders also included a sell transaction in each bundle, whereby the Victim Traders would sell their newly acquired cryptocurrency — immediately after the Lure Transaction — at a higher price than what they bought it for.” It was a sandwich trade: The arbitrageurs saw the Peraire-Bueno’s “lure” trades, which involved buying a bunch of illiquid crypto, and they front-ran them by buying the illiquid crypto before them and selling it after them.
5. But then they exploited a bug in Ethereum to get the full contents of the proposed block and to tamper with it by (1) “allow[ing] the Victim Traders to complete their buy transactions (i.e., their frontrun trades)” and (2) “replac[ing] the Lure Transactions with tampered transactions” in which they “sold the same illiquid cryptocurrencies that the Victim Traders had recently purchased,” and which they apparently already held. [[3]](imap://dave%40stucky%2Etech@mail.stucky.tech:993/fetch%3EUID%3E.INBOX%3E5707#footnote-3)
6. That is, they front-ran and spoofed the front-runners: They put in a big order saying “buy a ton of [some nonsense tokens],” front-running bots said “ooh, big bid for nonsense tokens, let’s get ahead of that,” and the front-running bots bought the nonsense tokens ahead of them. But then they tampered with the transactions to replace their own buy order with a _sell_ order, _selling_ the nonsense tokens — effectively, _to_ the front-runners — at inflated prices for $25 million. “In effect, the Tampered Transactions drained the particular liquidity pools of all the cryptocurrency that the Victim Traders had deposited based on their frontrun trades.”

Now. Is this … bad? Sure, I guess. In Step 5, the Peraire-Buenos do seem to have exploited a real vulnerability in how Ethereum’s consensus mechanism worked. I do not pretend to fully understand the technical details, but here is a [Flashbots postmortem](https://link.mail.bloombergbusiness.com/click/35403556.275801/aHR0cHM6Ly9jb2xsZWN0aXZlLmZsYXNoYm90cy5uZXQvdC9wb3N0LW1vcnRlbS1hcHJpbC0zcmQtMjAyMy1tZXYtYm9vc3QtcmVsYXktaW5jaWRlbnQtYW5kLXJlbGF0ZWQtdGltaW5nLWlzc3VlLzE1NDA/60e87ce39a995a4b1a2deb96B5c400aaf) of the exploit. (They sent a signed but invalid block header to the relay, which caused the relay to publish the contents of the proposed block, which they used to construct their own block exploiting those contents as the proposer of the block.) The Justice Department calls it “an alleged novel scheme by the defendants to exploit the very integrity of the Ethereum blockchain,” and that seems right: If people can reach in to alter the order of transactions to swipe $25 million, that does sort of undermine the integrity of the blockchain.

Also they did some bad googling. Before they did the trade, Anton Peraire-Bueno allegedly “searched online for cryptocurrency exchanges with limited ‘know your customer’ protocols and ways to launder cryptocurrency, including searches for ‘how to wash crypto’ and ‘cefi exchanges with no kyc.’” [[4]](imap://dave%40stucky%2Etech@mail.stucky.tech:993/fetch%3EUID%3E.INBOX%3E5707#footnote-4) And after the trade, as they were allegedly “laundering the fraud proceeds from the Exploit,” James Peraire-Bueno allegedly “searched online for, among other things, ‘money laundering,’ ‘exploit,’ ‘computer fraud abuse act,’ [[5]](imap://dave%40stucky%2Etech@mail.stucky.tech:993/fetch%3EUID%3E.INBOX%3E5707#footnote-5) and ‘does the united states extradite to [foreign country].’” The Justice Department, reasonably, cites these searches as evidence of a guilty conscience. Also though I wonder how well they worked? Like, has anyone ever (1) acquired $25 million of ill-gotten money, (2) googled “money laundering” and (3) successfully used to results to launder the money? On the other hand I bet googling “cefi exchanges with no kyc” works great; really exchanges should pay a lot for those keywords.

But to me what is wild about this case is that the Justice Department is bringing down the full weight of US federal criminal law to protect _Ethereum front-running bots_. The word “front-run” is right there in the indictment! The Justice Department has a [long](https://link.mail.bloombergbusiness.com/click/35403556.275801/aHR0cHM6Ly93d3cuanVzdGljZS5nb3YvdXNhby1lZG55L3ByL2Zvcm1lci1nbG9iYWwtaGVhZC1oc2JjLXMtZm9yZWlnbi1leGNoYW5nZS1jYXNoLXRyYWRpbmctZm91bmQtZ3VpbHR5LW9yY2hlc3RyYXRpbmc/60e87ce39a995a4b1a2deb96Ba19df7a5) [history](https://link.mail.bloombergbusiness.com/click/35403556.275801/aHR0cHM6Ly93d3cuanVzdGljZS5nb3YvdXNhby1zZG55L3ByL2Zvcm1lci1hbmFseXN0LWNoYXJnZWQtOC1taWxsaW9uLWluc2lkZXItdHJhZGluZy1zY2hlbWUtZnJvbnQtcnVubmluZy1lbXBsb3llci1z/60e87ce39a995a4b1a2deb96B5d27ba1b) of [prosecuting](https://link.mail.bloombergbusiness.com/click/35403556.275801/aHR0cHM6Ly93d3cuanVzdGljZS5nb3YvdXNhby1zZG55L3ByL3RyYWRlci1sYXJnZS1jYW5hZGlhbi1hc3NldC1tYW5hZ2VtZW50LWZpcm0tY2hhcmdlZC1pbnNpZGVyLXRyYWRpbmctZW5nYWdpbmc/60e87ce39a995a4b1a2deb96Bd4ed21ec) people for front-running! Because it is traditionally a crime! In traditional finance, “front-running” is understood to mean violating a fiduciary duty to your customers (or employer, etc.) by trading ahead of their orders, and it is a crime. [[6]](imap://dave%40stucky%2Etech@mail.stucky.tech:993/fetch%3EUID%3E.INBOX%3E5707#footnote-6)

But here the Justice Department is protecting the front-runners. And the trades that the Victim Traders were trying to do look, to the naked eye, bad? They were “we see you are trying to buy this illiquid cryptocurrency, so we’re going to buy it ahead of you so we can rip you off.” In Ethereum, that is pretty normal, and there is a large institutional structure to make it work in a predictable and fair-ish way. But in traditional markets it just seems bad.

We have talked a few times [about Avi Eisenberg](https://link.mail.bloombergbusiness.com/click/35403556.275801/aHR0cHM6Ly93d3cuYmxvb21iZXJnLmNvbS9vcGluaW9uL2FydGljbGVzLzIwMjQtMDQtMDkvYS1tZW1lLXN0b2NrLWZvci1wcml2YXRlLWNvbXBhbmllcz9jbXBpZD1CQkQwNTE2MjRfTU9ORVlTVFVGRiZ1dG1fbWVkaXVtPWVtYWlsJnV0bV9zb3VyY2U9bmV3c2xldHRlciZ1dG1fdGVybT0yNDA1MTYmdXRtX2NhbXBhaWduPW1vbmV5c3R1ZmY/60e87ce39a995a4b1a2deb96B648092cd), the crypto trader arrested (and convicted) for fraud because he did some market manipulation on a decentralized crypto exchange. He absolutely did do that manipulation, but his defense — which did not work — was that the crypto exchange did not have any norms _against_ it. What he did was allowed by the exchange’s code, he argued, so it was allowed. External norms like “don’t do market manipulation” did not apply. 

This is controversial, and a lot of people in and out of crypto have complaints of the form “look, if decentralized finance exchanges do not want to be subject to US regulation, why does the federal government need to protect them from market manipulators?” I am sympathetic to those complaints.

But here! I mean! Ethereum and its decentralized exchanges have a market structure that is like “bots can look at your transactions and front-run them if that’s profitable.” And these guys, allegedly, front-ran the front-runners; they turned the market structure around so that _they_ could get an early look at the front-running bots’ front-running transactions and front-run them instead. By hacking, sure, sure, it’s bad. But it leaves the Justice Department in the odd position of saying that the integrity of crypto front-running is important and must be defended.

[1] Especially because crypto DEXes generally [run mechanically](https://link.mail.bloombergbusiness.com/click/35403556.275801/aHR0cHM6Ly9jaGFpbi5saW5rL2VkdWNhdGlvbi1odWIvd2hhdC1pcy1hbi1hdXRvbWF0ZWQtbWFya2V0LW1ha2VyLWFtbQ/60e87ce39a995a4b1a2deb96B3d01a23b) so the price impact of a transaction is quite knowable.

[2] Do not email me about this, which is not the point. “Probabilistically make money by trading sort of in the middle of the execution of what they identify as a big order,” maybe.

[3] “Which the defendants already held as a result of information gathered through the bait transactions,” says the indictment. Presumably the intuition is like: You buy some illiquid crypto slowly over time, not moving the price. Then you send a big order to buy a lot of it, which gets front-runners interested. Then you pull it away.

[4] This trade relies on two sorts of exchanges, DeFi (decentralized finance) DEXes (decentralized exchanges) and CeFi (centralized finance) exchanges. The actual $25 million trade here has to happen *on the blockchain*, because that is where they are spoofing and tampering with transaction ordering; DEXes are where you trade crypto on the blockchain. But then getting the $25 million out requires a company that can wire money to your bank, and that is a centralized exchange. So he searched for CeFi exchanges to be the on -and off-ramp for the trade, which they did on decentralized exchanges.

[5] In fact they are charged with wire fraud, not with hacking under the [CFAA](https://link.mail.bloombergbusiness.com/click/35403556.275801/aHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvQ29tcHV0ZXJfRnJhdWRfYW5kX0FidXNlX0FjdA/60e87ce39a995a4b1a2deb96B8afad1f0), but it was probably reasonable to worry about getting charged with hacking too. But the lesson is probably that wire fraud is more general than CFAA hacking — everything is wire fraud! — so it’s the easier thing to charge.

[6] Of course, it is often used loosely to mean “using order book data to try to trade faster than someone else,” which is not traditional front-running and not a crime. And that’s mostly the meaning in the indictment here.
